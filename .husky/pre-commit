#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Block .env and similar secret files from being committed
# BUT ALLOW .env.example (it's just a template without real values)
if git diff --cached --name-only | grep -E '\.env($|\.local|\.js|\.ts)' | grep -v '\.env\.example'; then
  echo ""
  echo "❌ ERROR: Attempting to commit secret/environment files!"
  echo "   Files blocked: .env, .env.local, .env.*.local, secrets, private keys"
  echo "   Allowed: .env.example (template only)"
  echo ""
  echo "   To fix: git reset HEAD <file>"
  echo ""
  exit 1
fi

# Warn if committing to main without PR
if [ "$(git rev-parse --abbrev-ref HEAD)" = "main" ]; then
  echo "⚠️  WARNING: You are committing directly to main branch"
  echo "   Consider creating a feature branch instead"
fi

exit 0
